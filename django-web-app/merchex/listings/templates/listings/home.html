{% extends 'listings/base.html' %}

{% block content %}
{% load static %}
{% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}
<br><br>
<!-- Carrousel Inline CSS and JS -->
<style>
    .carousel-container {
        position: relative;
        width: 800px;
        height: 300px;
        margin: 0 auto;
        overflow: hidden;
        border-radius: 5px;
    }

        /* Media Queries for Responsive Design */
        @media (max-width: 1200px) {
        .carousel-container {
            width: 600px;
            height: 225px;
        }
    }

    @media (max-width: 992px) {
        .carousel-container {
            width: 500px;
            height: 187.5px;
        }
    }

    @media (max-width: 768px) {
        .carousel-container {
            width: 400px;
            height: 150px;
        }
    }

    @media (max-width: 576px) {
        .carousel-container {
            width: 300px;
            height: 112.5px;
        }
    }
    .carousel-slide {
        position: relative;
        width: 100%;
        height: 100%;
    }
    .carousel-slide img {
        position: absolute;
        width: 100%;
        height: 100%;
        object-fit: cover; /* This will ensure the image covers the area without distortion */
        object-position: center; /* This will center the image within the frame */
        opacity: 0;
        transition: opacity 1s ease-in-out;
    }
    .carousel-slide img.active {
        opacity: 1;
    }
</style>
<div class="carousel-container">
    <div class="carousel-slide" id="carousel-slide">
        <img src="{% static 'listings/images/0001.jpg' %}" alt="Upcoming event" class="active">
        <img src="{% static 'listings/images/0002.jpg' %}" alt="Upcoming event">
        <img src="{% static 'listings/images/0003.jpg' %}" alt="Upcoming event">
    </div>
</div>
<script>
    let slideIndex = 0;
    const slides = document.getElementById('carousel-slide').children;
    const totalSlides = slides.length;

    function showSlides() {
        // Hide all slides
        for (let i = 0; i < slides.length; i++) {
            slides[i].classList.remove('active');
        }

        // Show next slide
        slideIndex++;
        if (slideIndex >= totalSlides) {
            slideIndex = 0;
        }
        slides[slideIndex].classList.add('active');

        setTimeout(showSlides, 3000); // Change image every 3 seconds
    }

    showSlides();
</script>
<br><br><br><br>
<div class="home">Classified Ads</div>
<div class="event-container">
    {% for ad in ads %}
        <div class="event-border">
            <strong><span class="event-date">{{ ad.user.username }}</span></strong>  <div style="color: grey !important; font-size: O.6em !important">{{ ad.created_at|date:"d F Y" }}</div><em>{{ ad.title }}</em>
            <hr>
            <ul>
                <li><strong>{{ ad.get_category_display }}</strong></li>
                <hr>
                <li><strong>Description:</strong> {{ ad.description }}</li>
                <br>
                <li>
                    <div class="event-link-container">
                        <!-- Vous pouvez ajouter un lien ou une action spécifique à l'annonce ici si nécessaire -->
                        <a href="#" style="color: grey !important">Reply</a>
                    </div>
                </li>
            </ul>
            {% if ad.user == request.user %}
            <div style="color: grey; font-size: 0.8em;"><a href="{% url 'ad_update' ad.id %}" style="color: rgb(171, 171, 171) !important;">Update</a> | <a href="{% url 'ad_delete' ad.id %}" style="color: rgb(171, 171, 171) !important;">Delete</a></div>
            {% else %}
            <div style="color: grey; font-size: 0.8em;">Posted by {{ ad.user.username }}</div>
            {% endif %}
        </div>
    {% empty %}
        <li>No ads available at the moment.</li>
    {% endfor %}
</div>
<br>
<br>
{% endblock %}